(()=>{var e={450:function(e){e.exports=function(){var e=[],o=[],a={},n={},s={};function t(e){return"string"==typeof e?new RegExp("^"+e+"$","i"):e}function i(e,o){return e===o?o:e===e.toUpperCase()?o.toUpperCase():e[0]===e[0].toUpperCase()?o.charAt(0).toUpperCase()+o.substr(1).toLowerCase():o.toLowerCase()}function r(e,o){return e.replace(o[0],(function(a,n){var s,t,r=(s=o[1],t=arguments,s.replace(/\$(\d{1,2})/g,(function(e,o){return t[o]||""})));return i(""===a?e[n-1]:a,r)}))}function c(e,o,n){if(!e.length||a.hasOwnProperty(e))return o;for(var s=n.length;s--;){var t=n[s];if(t[0].test(o))return r(o,t)}return o}function l(e,o,a){return function(n){var s=n.toLowerCase();return o.hasOwnProperty(s)?i(n,s):e.hasOwnProperty(s)?i(n,e[s]):c(s,n,a)}}function u(e,o,a,n){return function(n){var s=n.toLowerCase();return!!o.hasOwnProperty(s)||!e.hasOwnProperty(s)&&c(s,s,a)===s}}function d(e,o,a){return(a?o+" ":"")+(1===o?d.singular(e):d.plural(e))}return d.plural=l(s,n,e),d.isPlural=u(s,n,e),d.singular=l(n,s,o),d.isSingular=u(n,s,o),d.addPluralRule=function(o,a){e.push([t(o),a])},d.addSingularRule=function(e,a){o.push([t(e),a])},d.addUncountableRule=function(e){"string"!=typeof e?(d.addPluralRule(e,"$0"),d.addSingularRule(e,"$0")):a[e.toLowerCase()]=!0},d.addIrregularRule=function(e,o){o=o.toLowerCase(),e=e.toLowerCase(),s[e]=o,n[o]=e},[["I","we"],["me","us"],["he","they"],["she","they"],["them","them"],["myself","ourselves"],["yourself","yourselves"],["itself","themselves"],["herself","themselves"],["himself","themselves"],["themself","themselves"],["is","are"],["was","were"],["has","have"],["this","these"],["that","those"],["echo","echoes"],["dingo","dingoes"],["volcano","volcanoes"],["tornado","tornadoes"],["torpedo","torpedoes"],["genus","genera"],["viscus","viscera"],["stigma","stigmata"],["stoma","stomata"],["dogma","dogmata"],["lemma","lemmata"],["schema","schemata"],["anathema","anathemata"],["ox","oxen"],["axe","axes"],["die","dice"],["yes","yeses"],["foot","feet"],["eave","eaves"],["goose","geese"],["tooth","teeth"],["quiz","quizzes"],["human","humans"],["proof","proofs"],["carve","carves"],["valve","valves"],["looey","looies"],["thief","thieves"],["groove","grooves"],["pickaxe","pickaxes"],["whiskey","whiskies"]].forEach((function(e){return d.addIrregularRule(e[0],e[1])})),[[/s?$/i,"s"],[/[^\u0000-\u007F]$/i,"$0"],[/([^aeiou]ese)$/i,"$1"],[/(ax|test)is$/i,"$1es"],[/(alias|[^aou]us|tlas|gas|ris)$/i,"$1es"],[/(e[mn]u)s?$/i,"$1s"],[/([^l]ias|[aeiou]las|[emjzr]as|[iu]am)$/i,"$1"],[/(alumn|syllab|octop|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i,"$1i"],[/(alumn|alg|vertebr)(?:a|ae)$/i,"$1ae"],[/(seraph|cherub)(?:im)?$/i,"$1im"],[/(her|at|gr)o$/i,"$1oes"],[/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|automat|quor)(?:a|um)$/i,"$1a"],[/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|hedr|automat)(?:a|on)$/i,"$1a"],[/sis$/i,"ses"],[/(?:(kni|wi|li)fe|(ar|l|ea|eo|oa|hoo)f)$/i,"$1$2ves"],[/([^aeiouy]|qu)y$/i,"$1ies"],[/([^ch][ieo][ln])ey$/i,"$1ies"],[/(x|ch|ss|sh|zz)$/i,"$1es"],[/(matr|cod|mur|sil|vert|ind|append)(?:ix|ex)$/i,"$1ices"],[/(m|l)(?:ice|ouse)$/i,"$1ice"],[/(pe)(?:rson|ople)$/i,"$1ople"],[/(child)(?:ren)?$/i,"$1ren"],[/eaux$/i,"$0"],[/m[ae]n$/i,"men"],["thou","you"]].forEach((function(e){return d.addPluralRule(e[0],e[1])})),[[/s$/i,""],[/(ss)$/i,"$1"],[/(wi|kni|(?:after|half|high|low|mid|non|night|[^\w]|^)li)ves$/i,"$1fe"],[/(ar|(?:wo|[ae])l|[eo][ao])ves$/i,"$1f"],[/ies$/i,"y"],[/\b([pl]|zomb|(?:neck|cross)?t|coll|faer|food|gen|goon|group|lass|talk|goal|cut)ies$/i,"$1ie"],[/\b(mon|smil)ies$/i,"$1ey"],[/(m|l)ice$/i,"$1ouse"],[/(seraph|cherub)im$/i,"$1"],[/(x|ch|ss|sh|zz|tto|go|cho|alias|[^aou]us|tlas|gas|(?:her|at|gr)o|ris)(?:es)?$/i,"$1"],[/(analy|ba|diagno|parenthe|progno|synop|the|empha|cri)(?:sis|ses)$/i,"$1sis"],[/(movie|twelve|abuse|e[mn]u)s$/i,"$1"],[/(test)(?:is|es)$/i,"$1is"],[/(alumn|syllab|octop|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i,"$1us"],[/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|quor)a$/i,"$1um"],[/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|hedr|automat)a$/i,"$1on"],[/(alumn|alg|vertebr)ae$/i,"$1a"],[/(cod|mur|sil|vert|ind)ices$/i,"$1ex"],[/(matr|append)ices$/i,"$1ix"],[/(pe)(rson|ople)$/i,"$1rson"],[/(child)ren$/i,"$1"],[/(eau)x?$/i,"$1"],[/men$/i,"man"]].forEach((function(e){return d.addSingularRule(e[0],e[1])})),["adulthood","advice","agenda","aid","alcohol","ammo","anime","athletics","audio","bison","blood","bream","buffalo","butter","carp","cash","chassis","chess","clothing","cod","commerce","cooperation","corps","debris","diabetes","digestion","elk","energy","equipment","excretion","expertise","flounder","fun","gallows","garbage","graffiti","headquarters","health","herpes","highjinks","homework","housework","information","jeans","justice","kudos","labour","literature","machinery","mackerel","mail","media","mews","moose","music","manga","news","pike","plankton","pliers","pollution","premises","rain","research","rice","salmon","scissors","series","sewage","shambles","shrimp","species","staff","swine","tennis","traffic","transporation","trout","tuna","wealth","welfare","whiting","wildebeest","wildlife","you",/[^aeiou]ese$/i,/deer$/i,/fish$/i,/measles$/i,/o[iu]s$/i,/pox$/i,/sheep$/i].forEach(d.addUncountableRule),d}()},533:(e,o,a)=>{o.scure=a(291),o.dsl=a(566),o.commands=a(255),o.lib=a(997)},255:(e,o,a)=>{o.scureAnswer=a(340).scureAnswer,o.scureBye=a(845).scureBye,o.scureFallback=a(375).scureFallback,o.scureHelp=a(994).scureHelp,o.scureInitializeState=a(669).scureInitializeState,o.scureInventory=a(604).scureInventory,o.scureLook=a(975).scureLook,o.scurePickup=a(704).scurePickup,o.scureTimeover=a(448).scureTimeover,o.scureUse=a(738).scureUse,o.scureWalk=a(774).scureWalk,o.scureWelcome=a(170).scureWelcome},807:(e,o,a)=>{const{aResponse:n}=a(326),{getPossibleDestinationsSentence:s}=a(491),{getDescription:t}=a(491),{handlePluginExtensions:i}=a(884),r={itemNotFound:e=>n(e.sentences.get("item-not-in-location")),itemDescription:(e,o,a)=>{const s=t(a.description,o,e);return n(i(s,o,e))},lookRoom:(e,o,a)=>{const i=e.rooms.getRoom(a),r=t(i.description,o,e),c=s(e,o);return n(`${r} ${c}`)}};o.responses=r},796:(e,o,a)=>{const{aResponse:n}=a(326),s={unknown:e=>n(e.sentences.get("item-unknown")),notSeen:(e,o)=>n(e.sentences.get("item-notseen",{name:o})),alreadyInInventory:(e,o)=>n(e.sentences.get("item-alreadyinventory",{name:o.name.toLowerCase()})),alreadyPicked:(e,o)=>n(e.sentences.get("item-alreadypicked",{name:o.name.toLowerCase()})),pickedUp:(e,o,a)=>{const s=a.pickingResponse?` ${a.pickingResponse}`:"",t=e.sentences.get("item-pickedup",{name:a.name.toLowerCase()});return n(`${t}${s}`,o)},itemNotPickable:(e,o)=>o.pickingResponse?n(o.pickingResponse):n(e.sentences.get("item-notpickable",{name:o.name.toLowerCase()})),itemNotPickableBecauseCondition:(e,o)=>n(o.pickable.response)};o.responses=s},340:(e,o,a)=>{const{resolveActions:n}=a(537),{aResponse:s}=a(326),{handlePluginExtensions:t}=a(884),{setExpectQuestion:i}=a(779),{stringReplace:r}=a(264),{numeralize:c}=a(887);o.scureAnswer=(e,o,a)=>{const l=o.question,u=a.answers.findByQuestion(l),d=((e,o,a)=>n=>t((e=>e.isUnlockingAction||e.isPickingAction||e.isExpectingAnswerAction)(n)?n.response:n,e,o,a))(o,a,e);if(o.question=void 0,!u)return s(a.sentences.get("answer-cant"),o);if(a.answers.isOk(u,e,o))return o=n(u.response,o),s(d(u.response),o);i(l,o);const m=r(d(u.sentenceWhenWrong),{userAnswer:c(e)});return s(m,o)}},845:(e,o,a)=>{const{aResponse:n}=a(326);o.scureBye=(e,o)=>((e=>{e.numCommands=0,e.roomId=null,e.startTime=null,e.inventory=[],e.picked=[]})(e),n(o.sentences.get("bye"),null))},375:(e,o,a)=>{const{aResponse:n}=a(326);o.scureFallback=(e,o)=>{if(e.numCommands<o.getInit().welcome.length){const a=o.getInit().welcome[e.numCommands];return n(a,e)}const a=o.getLeftTimeFrom(e.startTime);return n(o.sentences.get("fallback",{time:a}),e)}},994:(e,o,a)=>{const{aResponse:n}=a(326);o.scureHelp=(e,o)=>{const a=o.getLeftTimeFrom(e.startTime),s=o.sentences.get("help",{time:a});return n(s,e)}},669:(e,o)=>{o.scureInitializeState=(e,o)=>(o=((e,o)=>(o.roomId=o.roomId||e.getInit().roomId,o))(e,o=(e=>(e.startTime=e.startTime||JSON.stringify(new Date),e))(o=o||{})),(e=>{var o;return e.numCommands=(o=e.numCommands)?o+1:1,e})(o))},604:(e,o,a)=>{const{aResponse:n}=a(326),{joinMultipleStrings:s}=a(491);o.scureInventory=(e,o)=>{if(!e.inventory)return n(o.sentences.get("inventory-nothing"));const a=e.inventory.slice().map((e=>o.items.getItem(e).name)),t=s(a,e.language),i=o.sentences.get("inventory",{items:t});return n(i)}},975:(e,o,a)=>{const{isEmptyArg:n}=a(283),{responses:s}=a(807),t=["habitación","habitacion","lugar","lugares","room","rooms","space","place","sala","salón","salita","la sala"];o.scureLook=(e,o,a)=>{const i=(e=>e.roomId)(o),r=a.items.getBestItem(e,o,a);return n(e)||(e=>t.indexOf(e)>=0)(e)?s.lookRoom(a,o,i):((e,o,a,n)=>!n||!((e,o,a)=>e.items.isInInventory(o.id,a.inventory))(e,n,o)&&!((e,o)=>null===e.location||o===e.location&&null!==e.location)(n,a))(a,o,i,r)?s.itemNotFound(a):(o.lastItem=r.id,s.itemDescription(a,o,r))}},704:(e,o,a)=>{const{isEmptyArg:n}=a(283),{responses:s}=a(796),{matchesCondition:t}=a(609);o.scurePickup=(e,o,a)=>{const{roomId:i}=o,r=a.items.getItemByName(e);return n(e)?s.unknown(a):r?i!==r.location?s.notSeen(a,r.name.toLowerCase()):a.items.isInInventory(r.id,o.inventory)?s.alreadyInInventory(a,r):((e,o,a)=>e.pickable.isPickingCondition&&!t(o,a)(e.pickable.condition))(r,o,a)?s.itemNotPickableBecauseCondition(a,r):(e=>!e.pickable.isPickingCondition&&!e.pickable)(r)?s.itemNotPickable(a,r):a.items.isPicked(r.id,o.picked)?s.alreadyPicked(a,r):(((e,o)=>{e.inventory=e.inventory||[],e.inventory.push(o),e.picked=e.picked||[],e.picked.push(o)})(o,r.id),s.pickedUp(a,o,r)):s.notSeen(a,e)}},448:(e,o,a)=>{const{getDescription:n}=a(491),{aResponse:s}=a(326);o.scureTimeover=(e,o)=>{(e=>{e.numCommands=0,e.roomId=null,e.startTime=null,e.inventory=[],e.picked=[]})(e);const a=n(o.sentences.get("end-timeover"),e,o);return s(a,e)}},738:(e,o,a)=>{const{isEmptyArg:n}=a(283),{aResponse:s}=a(326),{buildUsageIndex:t,getDescription:i,getConsumesObjects:r,addItemIdTo:c}=a(491),{resolveActions:l}=a(537),{handlePluginExtensions:u}=a(884),d=(e,o)=>a=>u((e=>e.isUnlockingAction||e.isPickingAction||e.isExpectingAnswerAction)(a)?a.response:a,e,o),m=(e,o,a,n,s,t)=>(s=((e,o)=>{const a=o;return e.pickable&&c(e.id,o,"picked"),a})(e,s),((e,o,a,n)=>o.isConditional?r(o.conditions,a,n):e.onlyOnce)(o,a,s,t)&&(s=((e,o,a)=>{const n=o;return a.items.isInInventory(e,o.inventory)&&n.inventory.splice(n.inventory.indexOf(e),1),n})(e.id,s,t)),s),p=(e,o,a)=>e.isConditional?i(e.conditions,o,a):e;o.scureUse=(e,o,a)=>{const i=((e,o,a)=>{if(e&&0===e.length)return a.sentences.get("use-noarg");for(let s=0;s<e.length;s+=1){const t=e[s];if(n(t))return a.sentences.get("use-noarg");const i=a.items.getBestItem(t,o);if(!i)return a.sentences.get("use-cant",{item:t});const r=a.items.isInInventory(i.id,o.inventory),c=i.location===o.roomId&&null!==i.location||null===i.location;if(!r&&!c)return a.sentences.get("use-cant",{item:t})}return null})(e,o,a);return i?s(i,o):1===e.length?((e,o,a)=>{const n=a.items.getBestItem(e,o),t=a.usages.getByItemId(n.id);if(!t)return s(a.sentences.get("use-cant",{item:e}));if(o.lastItem=n.id,t.onlyOnce&&a.usages.isUsed(n.id,o.usages))return s(a.sentences.get("use-onlyonce"));const i=((e,o,a)=>o.response[((e,o)=>o&&o[e.id]||0)(e,a)%o.response.length])(n,t,o.usages),r=p(i,o,a);o=l(r,o),(o=m(n,t,i,0,o,a)).usages=a.usages.increaseUsage(n,o.usages);const c=d(o,a);return s(c(r),o)})(e[0],o,a):((e,o,a,n)=>{const i=n.items.getBestItem(e,a),r=n.items.getBestItem(o,a);if(!i||!r)return s(n.sentences.get("use-canttwo",{item1:e,item2:o}));a.lastItem=[i.id,r.id];const c=n.usages.getByItemIds(i.id,r.id);if(!c)return s(n.sentences.get("use-canttwo",{item1:e,item2:o}));const u=n.usages.isUsedCombination(i.id,r.id,a.usages);if(c.onlyOnce&&u)return s(n.sentences.get("use-onlyonce-two"));const g=((e,o,a,n)=>a.response[((e,o,a)=>a&&a[t(e.id,o.id)]||0)(e,o,n)%a.response.length])(i,r,c,a.usages),h=p(g,a,n);a=l(h,a),a=m(i,c,g,0,a,n),(a=m(r,c,g,0,a,n)).usages=n.usages.increaseUsageForTwo(i,r,a.usages);const b=d(a,n);return s(b(h),a)})(e[0],e[1],o,a)}},774:(e,o,a)=>{const{isEmptyArg:n}=a(283),{aResponse:s}=a(326),{getPossibleDestinationsSentence:t}=a(491),{getDescription:i}=a(491),r=(e,o,a)=>{const n=t(o,a);return`${o.sentences.get("destination-unknown",{destination:e})} ${n}`};o.scureWalk=(e,o,a)=>{if(n(e)){const e=((e,o)=>{const a=t(e,o);return""!==a?a:e.sentences.get("walk-nowhere")})(a,o);return s(e,o)}const c=a.rooms.getRoomsByName(e);if(!c||0===c.length)return s(r(e,a,o),o);const l=a.getCanJumpRooms()?c.find((u=a.rooms,d=o.roomId,m=o.unlocked,e=>u.isDestinationJumpableFrom(e.id,d,m))):c.find(((e,o,a)=>n=>e.isAllowedDestinationId(n.id,o,a))(a.rooms,o.roomId,o.unlocked));var u,d,m;return l?(o.roomId=l.id,s(i(l.description,o,a),o)):s(((e,o,a)=>{const n=o.rooms.isDestinationLockedAndInMap(e,a.roomId,a.unlocked),s=o.rooms.getDestinationLockedSentence(e,a.roomId);return n&&s?s:r(e,o,a)})(e,a,o),o)}},170:(e,o,a)=>{const{aResponse:n}=a(326);o.scureWelcome=(e,o)=>n(o.getInit().welcome[0],e)},566:(e,o)=>{o.aRoom=(e,o,a,n)=>({id:e,name:o,synonyms:a,description:n}),o.anItem=(e,o,a,n,s,t,i)=>({id:e,name:o,synonyms:a,description:n,location:s,pickable:t,pickingResponse:i}),o.anUsage=(e,o,a)=>({items:e,response:o,onlyOnce:a}),o.anUnlockingAction=(e,o)=>({isUnlockingAction:!0,response:e,lock:o}),o.anExpectAnswerAction=(e,o)=>({isExpectingAnswerAction:!0,response:e,question:o}),o.aConditionalResponse=e=>({isConditional:!0,conditions:e}),o.aLockedDestination=(e,o,a=null)=>({isLockedDestination:!0,roomId:e,lockCondition:o,sentence:a}),o.aCondDesc=(e,o)=>({conditional:!0,condition:e,description:o}),o.aCondDescUsage=(e,o,a)=>({conditional:!0,consumesObjects:e,condition:o,description:a}),o.theEndingScene=e=>({isEndingScene:!0,description:e}),o.anAnswer=(e,o,a,n)=>({question:e,answer:o,response:a,sentenceWhenWrong:n}),o.pluginExtension=(...e)=>({isPluginExtension:!0,data:e}),o.aPickingAction=(e,o)=>({isPickingAction:!0,response:e,itemId:o}),o.aCommandSyn=(e,o,a)=>({fromCommand:e,arg:o,toCommand:a}),o.Commands={WALK:"walk",USE:"use",PICKUP:"pickup",LOOK:"look"}},898:(e,o)=>{o.getCommandSyn=(e,o,a,n)=>n.data.commandSyns?((e,o,a,n)=>{const s=e.data.commandSyns.find(((e,o,a,n)=>s=>s.fromCommand===e&&((e,o,a,n)=>{const s=n.items.getBestItem(e,a,n);return!!s&&s.id===o&&((e,o,a)=>a&&(((e,o,a)=>e.items.isInInventory(o.id,a.inventory))(e,a,o)||((e,o)=>null===e.location||o===e.location&&null!==e.location)(a,o.roomId)))(n,a,s)})(o,s.arg,a,n))(o,a,n,e));return s?s.toCommand:null})(n,e,o,a):null},283:(e,o)=>{o.isEmptyArg=e=>!e||void 0!==e.length&&0===e.length||"[]"===JSON.stringify(e).trim()||"{}"===JSON.stringify(e).trim()||!(!e.trim||""!==e.trim()),o.baseChars=e=>e.toLowerCase().replace(/[áäàÀÁÂÃÄÅ]/g,"a").replace(/[èéèÈÉÊË]/g,"e").replace(/[íìIÎ]/g,"i").replace(/[óòÓÔ]/g,"o").replace(/[úùüÙ]/g,"u").replace(/[çÇ]/g,"c").replace(/[ñÑ]/g,"n").replace(/[-\\?]/g,"")},609:(e,o,a)=>{const{stateIsUnlocked:n}=a(722);o.matchesCondition=(e,o)=>a=>{if(-1===a.indexOf(":"))return!0;const[s,t]=a.split(":",2),i=s.startsWith("!");if("picked"===s||"!picked"===s){const a=o.items.isPicked(t,e.picked);return i&&!a||!i&&a}if("unlocked"===s||"!unlocked"===s){const o=n(e,t);return i&&!o||!i&&o}return!0}},779:(e,o)=>{o.setExpectQuestion=(e,o)=>{o.question=e,o.lastContext="expecting-answer"}},997:(e,o,a)=>{a(722).stateIsUnlocked,a(722).stateLock,o.stateUnlock=a(722).stateUnlock,o.getCommandSyn=a(898).getCommandSyn},884:(e,o)=>{o.handlePluginExtensions=(e,o,a,n)=>e.isPluginExtension?((e,o,a,n)=>e.data.map(((e,o,a)=>n=>"function"==typeof n?((e,o,a,n)=>e(o,a,n))(n,e,o,a):n)(o,a,n)).join(""))(e,o,a,n):e},537:(e,o,a)=>{const{addItemIdTo:n}=a(491),{stateUnlock:s}=a(722),{setExpectQuestion:t}=a(779);o.resolveActions=(e,o)=>(o=((e,o)=>(e.isUnlockingAction&&s(o,e.lock),o))(e,o),o=((e,o)=>(e.isPickingAction&&(n(e.itemId,o,"picked"),n(e.itemId,o,"inventory")),o))(e,o),o=((e,o)=>(e.isExpectingAnswerAction&&t(e.question,o),o))(e,o),o)},722:(e,o)=>{o.stateUnlock=(e,o)=>{e.unlocked||(e.unlocked=[]),-1===e.unlocked.indexOf(o)&&e.unlocked.push(o)},o.stateLock=(e,o)=>{e.unlocked||(e.unlocked=[]),e.unlocked=e.unlocked.filter((e=>e!==o))},o.stateIsUnlocked=(e,o)=>void 0!==e.unlocked&&e.unlocked.indexOf(o)>=0},887:(e,o)=>{o.numeralize=e=>e.replace(/\buno\b/g,"1").replace(/\bdos\b/g,"2").replace(/\btres\b/g,"3").replace(/\bcuatro\b/g,"4").replace(/\bcinco\b/g,"5").replace(/\bseis\b/g,"6").replace(/\bsiete\b/g,"7").replace(/\bocho\b/g,"8").replace(/\bnueve\b/g,"9").replace(/\bcero\b/g,"0").replace(/\D/g,"")},264:(e,o)=>{o.stringReplace=(e,o)=>Object.keys(o).reduce(((e,a)=>e.replace(`{${a}}`,o[a])),e)},512:(e,o,a)=>{const{numeralize:n}=a(887);o.ScureAnswers=class{constructor(e){this.answers=e}findByQuestion(e){return this.answers.find((o=>o.question===e))}isOk(e,o,a){return e.answer.startsWith("var:")?((e,o,a)=>{const s=e.replace(/var:/g,"");return n(o)===`${a[s]}`})(e.answer,o,a):e.answer===n(o)}}},56:(e,o,a)=>{const{isEmptyArg:n}=a(283),{isTextEqual:s}=a(491),{isSynonym:t}=a(491);o.ScureItems=class{constructor(e){this.items=e}getItem(e){return this.items.find((o=>o.id===e))}getItemByName(e){return n(e)?null:this.items.find((o=>s(o.name,e)||t(o.synonyms,e)))}getItemByNameAndRoom(e,o){return n(e)?null:this.items.find((a=>(s(a.name,e)||t(a.synonyms,e))&&a.location===o))}getItemByNameAndInventory(e,o){if(n(e))return null;const a=o||[];return this.items.find((o=>(s(o.name,e)||t(o.synonyms,e))&&a.indexOf(o.id)>=0))}getBestItem(e,o){const a=this.getItemByNameAndRoom(e,o.roomId);if(a)return a;return this.getItemByNameAndInventory(e,o.inventory)||this.getItemByName(e)}isInInventory(e,o){return!!o&&!!this.getItem(e)&&"number"==typeof o.length&&o.indexOf(e)>=0}isPicked(e,o){return!!o&&!!this.getItem(e)&&"number"==typeof o.length&&o.indexOf(e)>=0}}},663:(e,o,a)=>{const{isTextEqual:n}=a(491),{joinMultipleStrings:s}=a(491),{isSynonym:t}=a(491),i=(e,o)=>void 0===o.lockCondition||o&&e&&e.indexOf(o.lockCondition)>=0,r=e=>null!==e,c=(e,o,a)=>e[o].map((e=>o=>o.isLockedDestination?i(e,o)?o.roomId:null:o)(a)).filter(r),l=(e,o,a,n)=>{if(!n[e])return!1;const s=c(n,e,a);return s&&s.indexOf(o)>=0},u=(e,o,a,n,s)=>{if(!n[e])return!1;if(s[e])return!1;const t=c(n,e,a);if(s[e]=1,!t)return!1;for(let e=0;e<t.length;e+=1)if(l(t[e],o,a,n))return!0;for(let e=0;e<t.length;e+=1){const i=u(t[e],o,a,n,s);if(s[t[e]]=1,i)return!0}return!1};o.ScureRooms=class{constructor(e,o){this.rooms=e,this.map=o}getRoom(e){return this.rooms.find((o=>o.id===e))}getRoomByName(e){return this.rooms.find((o=>n(o.name,e)||t(o.synonyms,e)))}getRoomsByName(e){return this.rooms.filter((o=>n(o.name,e)||t(o.synonyms,e)))}isAllowedDestinationId(e,o,a){return c(this.map,o,a).indexOf(e)>=0}isDestinationJumpableFrom(e,o,a){return!!this.map[o]&&(!!this.getRoom(e)&&(!!l(o,e,a,this.map)||u(o,e,a,this.map,[])))}isDestinationLockedAndInMap(e,o,a){const n=this.getRoomByName(e),s=(t=this.map,c=o,l=n.id,t[c].find((u=l,e=>e.isLockedDestination&&e.roomId===u||!e.isLockedDestination&&e===u)));var t,c,l,u;const d=((e,o,a,n)=>((e,o,a)=>e[o].map((e=>o=>o.isLockedDestination&&!i(e,o)?o.roomId:null)(a)).filter(r))(e,o,n).indexOf(a)>=0)(this.map,o,n.id,a);return s&&d}getDestinationLockedSentence(e,o){const a=this.getRoomByName(e),n=this.map[o].find((s=a.id,e=>e.isLockedDestination&&e.roomId===s));var s;return n?n.sentence:null}getPossibleDestinationNamesFrom(e,o){const a=c(this.map,e,o),n=a.map((e=>this.getRoom(e).name));return a.length>1?s(n):n}}},760:(e,o)=>{o.ScureSentences=class{constructor(e){this.sentences=e}get(e,o){return o&&0!==o.length?Object.keys(o).reduce(((e,a)=>e.replace(`{${a}}`,o[a])),this.sentences[e]):this.sentences[e]}}},955:(e,o,a)=>{const{buildUsageIndex:n}=a(491),s=(e,o)=>("[]"===JSON.stringify(o)&&(o={}),"object"!=typeof o&&(o={}),o||(o={}),o[e]=o[e]+1||1,o);o.ScureUsages=class{constructor(e){this.usages=e}getByItemId(e){return this.usages.find((o=>o.items===e))}getByItemIds(e,o){return this.usages.find((a=>a.items.indexOf(e)>=0&&a.items.indexOf(o)>=0))}isUsed(e,o){return!!o&&!!this.getByItemId(e)&&!!o[e]&&o[e]>=1}isUsedCombination(e,o,a){return!!a&&(!!this.getByItemIds(e,o)&&a[n(e,o)]>=1)}increaseUsage(e,o){return!!this.getByItemId(e.id)&&s(e.id,o)}increaseUsageForTwo(e,o,a){if(!this.getByItemIds(e.id,o.id))return!1;const t=n(e.id,o.id);return s(t,a)}}},491:(e,o,a)=>{const{matchesCondition:n}=a(609),{isEmptyArg:s}=a(283),{removeStopwords:t}=a(982),{singularizeWords:i}=a(733),r=e=>i(t(e.toLowerCase().replace(/[áäàÀÁÂÃÄÅ]/g,"a").replace(/[èéèÈÉÊË]/g,"e").replace(/[íìIÎ]/g,"i").replace(/[óòÓÔ]/g,"o").replace(/[úùüÙ]/g,"u").replace(/[çÇ]/g,"c").replace(/[-]/g,""))).replace(/\s+/g," ").trim().replace(/\d\s+\d/g,(e=>e.replace(/\s+/g,""))),c=(e,o,a)=>{const s=e.filter((e=>n(o,a)(e.condition)));return s.length>0?s[0]:null};o.joinMultipleStrings=(e,o)=>{if(1===e.length)return e[0];const a="en"===o?"and":"y";return`${e.slice(0,e.length-1).join(", ")} ${a} ${e[e.length-1]}`},o.isSynonym=(e,o)=>(e||[]).map(r).indexOf(r(o))>=0,o.isTextEqual=(e,o)=>{const a=r(e),n=r(o);return!s(a)&&!s(n)&&a===n},o.getPossibleDestinationsSentence=(e,o)=>{const a=e.rooms.getPossibleDestinationNamesFrom(o.roomId,o.unlocked);return a.length>0?e.sentences.get("destinations",{destinations:a}):""},o.getDescription=(e,o,a)=>{if("string"==typeof e)return e;if(void 0===e[0])return e;const n=c(e,o,a);return n?n.description:e[e.length-1].description},o.getConsumesObjects=(e,o,a)=>{if("string"==typeof e)return!1;const n=c(e,o,a);return n?n.consumesObjects:e[e.length-1].consumesObjects},o.buildUsageIndex=(e,o)=>[e,o].sort().join("-"),o.addItemIdTo=(e,o,a)=>{o[a]=o[a]||[],-1===o[a].indexOf(e)&&o[a].push(e)}},326:(e,o)=>{o.aResponse=(e,o)=>({sentence:e,data:o})},733:(e,o,a)=>{const n=a(450).singular,s=e=>(e=>e&&e.length>=4&&e.endsWith("s"))(e)?n(e):e;o.singularizeWords=e=>e.split(" ").map(s).join(" ")},982:(e,o)=>{const a=["a","about","at","for","from","fucking","his","in","is","of","on","the","that","through","your","al","de","desde","el","en","entre","hacia","la","los","las","maldita","mi","para","por","puta","que","sobre","su","tu","un","una","esa","esta","ese"],n=e=>-1===a.indexOf(e);o.removeStopwords=e=>{return o=e,a.indexOf(o)>-1?e:e.split(" ").filter(n).join(" ");var o}},291:(e,o,a)=>{const{ScureAnswers:n}=a(512),{ScureSentences:s}=a(760),{ScureUsages:t}=a(955),{ScureItems:i}=a(56),{ScureRooms:r}=a(663);class c{constructor(e){this.data=e,this.sentences=new s(e.sentences),this.items=new i(e.items),this.rooms=new r(e.rooms,e.map),this.usages=new t(e.usages),this.answers=new n(e.answers)}getInit(){return this.data.init}getMapImage(){return this.data.mapImage}getCanJumpRooms(){return!(!this.data||!this.data.init)&&this.data.init.canJumpRooms}getLeftTimeFrom(e){const o=new Date(JSON.parse(e)),a=((new Date).getTime()-o.getTime())/1e3,n=60*this.getInit().totalMinutes-a,s=Math.floor(n/60),t=Math.floor(n%60);return this.sentences.get("remaining-time",{minutes:s,seconds:t})}}o.buildScureFor=e=>new c(e)}},o={};function a(n){var s=o[n];if(void 0!==s)return s.exports;var t=o[n]={exports:{}};return e[n].call(t.exports,t,t.exports,a),t.exports}(()=>{"use strict";const e={6143:"caja-fuerte-answer-6143",3416:"caja-fuerte-answer-3416",3584:"caja-fuerte-answer-3584",default:"caja-fuerte-answer-default"};var o=a(533);const{stateUnlock:n}=o.lib,s=(e,o,a)=>(s,t,i)=>(((e,o)=>{e.inventory=e.inventory||[],e.inventory.push(o),e.picked=e.picked||[],e.picked.push(o)})(s,e),n(s,o),a),{stateUnlock:t}=o.lib,i={rooms:{recibidor:["entrada","recibidor","sala de la entrada","sala recibidor","salón recibidor","hall"],cocina:["cocina","despensa","sala de la cocina"],"sala-estar":["sala de estar","sala","salón","sala principal"],dormitorio:["dormitorio","dormidor","habitación","sala de la cama"],sotano:["sótano","bunker","bodega"]},items:{"artilugio-dorm":["artilugio","artilugio con palancas","aparato","artilugio cuadrado","artilugio cuadrado con palancas","palancas","puerta","puerta del infierno","infierno","inframundo","puerta del inframundo","puerta infierno","puerta inframundo","muerte","otra dimensión","puerta a otra dimensión","puerta de la dimensión","artilugio del infierno","artilugio infernal","puerta infernal","espíritus","otros espíritus"],"mural-recib":["mural","mural en la pared","mural de la pared","cuadro","cuadro en pared","colores","letras"],"estanteria-recib":["estantería","biblioteca","libros","libreria"],"libro-espiritus-recib":["libro sobre espíritus","lectura de espíritus","libro sobre los espíritus","libro con espíritus","el de los espíritus","libro de espectros","libros de expectros","páginas","más páginas","siguientes páginas"],"libro-colores-recib":["libro sobre colores","libro del arte de colores","libro de arte de colores","libro sobre los colores","el arte de los colores","páginas","más páginas","siguientes páginas"],"arcon-recib":["arcón","arcón del recibidor","arcón en el recibidor","baúl","baúl en el recibidor","caja","candado","cerradura"],"escudo-recib":["escudo del recibidor","escudo dentro del arcón","escudo del arcón","escudo del baúl","escudo de dentro del baúl","escudo de dentro del arcón"],"mesa-recib":["mesa","mesa del recibidor","mesa con velas"],"hechizo-recib":["hechizo","hechizo para bendecir agua","hechizo para agua bendita","hechizo para el agua","hechizo para bendecir agua","hechizo de agua bendita"],"chimenea-sala":["chimenea","chimenea del salón","chimenea bajo el cuadro","chimenea en la sala","chimenea y cuadro","chimenea con cuadro"],"cuadro-sala":["cuadro","cuadro sobre la chimenea","cuadro de encima de la chimenea","cuadro de encima"],"lobo-sala":["lobo","espíritu","fantasma","espectro","espíritu del lobo","espíritu de lobo","fantasma del lobo","fantasma de lobo","lobezno"],"espiritu-cocina":["espíritu","espíritu de fuego","fantasma de fuego","fuego","espectro"],"vaso-cocina":["vaso","vaso lleno de agua","vaso con agua","vaso de agua","vaso a tope de agua","agua"],"mesa-cocina":["mesa","mesa de la cocina","mesa con vaso de agua","mesa del vaso","mesa en la cocina","mesa de cocina"],"armario-cocina":["armarios","armario de la cocina","armario en la cocina","armario","cuchillos","cucharas","tenedores","tenedor","cuchillo","cuchara","cuchillos cucharas y tenedores","cuchillos cucharas","juegos de cocina","juegos","cubiertos","cubierto","juego de cubiertos"],"cama-dormitorio":["cama","almohada","catre"],"yo-sotano":["tu","yo","a mi","mi","a yo","humano","humano en el suelo","hombre","persona"],"mueble-sotano":["figuras","mueble","ciclope","humano del mueble","persona del mueble","hombre en el mueble","mesa"],"caja-sotano":["caja fuerte","caja","cerradura","candado","combinación"]}},r='<audio src="https://actions.google.com/sounds/v1/animals/animal_bark_and_growl.ogg" clipEnd="2800ms"/>',c=r+'El espíritu me ataca, así que preparo el escudo.<audio src="https://actions.google.com/sounds/v1/impacts/windshield_hit_with_bar.ogg" clipEnd="2700ms"/><par>  <media xml:id="theaudio" fadeOutDur="5s" end="thetext.end">    <audio src="https://actions.google.com/sounds/v1/animals/dog_whining.ogg" clipBegin="7s" soundLevel="+25dB"/>  </media>  <media xml:id="thetext">Al defenderme con el escudo, el lobo ha quedado herido y huye.     ¡Corre, lobo, corre!  </media></par>',l='<par><media xml:id="fire" end="grito.end">  <audio src="https://actions.google.com/sounds/v1/ambiences/fire.ogg" soundLevel="+25dB"/>  </media>  <media xml:id="grito">  <audio src="https://actions.google.com/sounds/v1/horror/aggressive_zombie_snarls.ogg"  soundLevel="-20dB" clipEnd="2700ms"/></media></par>',{theEndingScene:u,anUnlockingAction:d,aPickingAction:m,anAnswer:p,aCommandSyn:g,Commands:h,aRoom:b,anItem:y,aLockedDestination:v,aCondDescUsage:f,aCondDesc:k,anUsage:w,aConditionalResponse:I,pluginExtension:q,anExpectAnswerAction:x}=o.dsl,E={sentences:{help:"Me puedes dar instrucciones para que vaya de un sitio a otro, para mirar objetos, usarlos y cogerlos. Por ejemplo, puedes pedirme que mire alrededor para ver qué hay. Quedan {time}. ","help-no-screen":"Me puedes dar instrucciones para que vaya de un sitio a otro, para mirar objetos, usarlos y cogerlos. Quedan {time}. ",fallback:"Perdona, no te entiendo. Respondo mejor a comandos como mirar, usar, coger e ir. Quedan {time}. ",destinations:"Desde aquí puedo ir a: {destinations}. ","destination-unknown":"No sé ir a {destination}. ","remaining-time":"{minutes} minutos y {seconds} segundos","ending-remaining-time":"Quedaban {timeLeft}","item-not-in-location":"No encuentro o veo ese objeto. ","item-notseen":"No veo el objeto {name} por aquí. ","item-unknown":"No te he entendido qué quieres que me lleve. ","item-pickedup":"Ok, me llevo el objeto {name}. ","item-notpickable":"No puedo llevarme el objeto {name}. ","item-alreadyinventory":"Ya llevo el objeto {name}. ","item-alreadypicked":"Ya me llevo el objeto {name}. ","use-noarg":"Dime qué objeto u objetos quieres que use. ","use-cant":"No puedo usar el objeto {item}. ","use-canttwo":"No puedo usar los objetos {item1} y {item2} entre sí. ","use-onlyonce":"Ya utilicé ese objeto. No puedo usarlo otra vez. ","use-onlyonce-two":"Ya utilicé esos objetos. No puedo usarlos otra vez. ",inventory:"Llevo los siguientes objetos encima: {items}. ","inventory-nothing":"No llevo nada encima. ",bye:"Ha sido un placer trabajar contigo. Es una lástima que no hayamos podido salvarnos. Intentémoslo otra vez más adelante. ¡Gracias!","end-timeover":[k("!unlocked:closed-hell","Ya no hay tiempo; no hemos cerrado la puerta del inframundo y esto ha permitido que el infierno se haya desatado en la tierra. La humanidad arderá hasta el fin de sus días. Lo siento. ¡Intentémoslo otra vez!"),k("unlocked:closed-hell","Ya no hay tiempo; te has desangrado y has muerto. Lo siento. ¡Intentémoslo otra vez!")],"answer-cant":"¿Perdona? No estaba esperando una respuesta. Si me estás contestando a un código, utiliza antes el objeto en cuestión.","walk-nowhere":"Desde aquí no podemos ir a ningún sitio. ¡Busca una salida!","walking-sound":['<audio src="https://actions.google.com/sounds/v1/doors/creaking_wooden_door.ogg" clipEnd="2700ms"/>','<audio src="https://actions.google.com/sounds/v1/doors/locked_doorknob_jiggle.ogg"/>','<audio src="https://actions.google.com/sounds/v1/doors/wood_door_open_close.ogg"/>','<audio src="https://actions.google.com/sounds/v1/doors/wood_door_open.ogg"/>'],"final-question":"¿Qué hacemos ahora?","arcon-wrong":"No, ese número no abre el baúl.","arcon-wrong-back":"No, ese número no abre el baúl... Pero me pregunto si las letras del mural querrán decir algo.","caja-fuerte-answer-3584":"No creo que haya que ponerlo al revés. Demasiado rebuscado.","caja-fuerte-answer-6143":"¿No has oído nunca lo de que un código solo sirve una vez? Venga, dime qué hacemos ahora.","caja-fuerte-answer-3416":"¿No has oído nunca lo de que un código solo sirve una vez? Venga, dime qué hacemos ahora.","caja-fuerte-answer-default":"No, parece que ese código no es."},init:{totalMinutes:20,roomId:"recibidor",welcome:['<speak><par>  <media end="thetext.end">    <audio src="https://actions.google.com/sounds/v1/animals/crows_caw_in_field.ogg" soundLevel="+20dB"></audio>  </media>  <media xml:id="thetext" begin="1s">     ¡Hola! Soy Dron Johnson. Encantado de conocerte.     Estoy en las afueras de una mansión, donde los espíritus campan a sus anchas, ya que se ha abierto una puerta que lleva al inframundo.    Voy a entrar yo solo, ya que es demasiado peligrosa para humanos.     Tú dame instrucciones y yo las ejecutaré. Voy a entrar.   </media></par><audio src="https://actions.google.com/sounds/v1/doors/opening_closing_heavy_door.ogg"  clipBegin="1s" clipEnd="6s"></audio>De acuerdo, ya estoy en el recibidor. Aquí veo una estantería, un mural en la pared, un baúl y una mesa. <emphasis level="strong">Tenemos 20 minutos. ¡Rápido! Dime qué hacemos.</emphasis></speak>'],canJumpRooms:!0},rooms:[b("recibidor","recibidor",i.rooms.recibidor,"En el recibidor puedo ver un baúl, un mural en la pared, una estantería y una mesa."),b("cocina","cocina",i.rooms.cocina,[k("!unlocked:killed-spirit-fire",l+"En la cocina veo un espíritu que arde y flota en el centro. Además, veo una mesa con un vaso de agua y un armario."),k("unlocked:killed-spirit-fire","En la cocina veo una mesa con un vaso de agua y un armario.")]),b("sala-estar","sala de estar",i.rooms["sala-estar"],[k("!unlocked:killed-spirit-wolf",r+"Eso es un espíritu de un lobo que se mueve por la habitación. Además, en el salón veo una chimenea y un cuadro encima."),k("unlocked:killed-spirit-wolf","Este salón tiene una chimenea y un cuadro encima.")]),b("dormitorio","dormitorio",i.rooms.dormitorio,[k("!unlocked:closed-hell","En el dormitorio veo una cama grande y un artilugio cuadrado con palancas. En el centro del artilugio puedo ver el infierno."),k("unlocked:closed-hell","En el dormitorio veo una cama grande y el artilugio cerrado. Una grieta se ha abierto en el suelo, hacia el sótano.")]),b("sotano","sótano",i.rooms.sotano,"Esto es el sótano. En él te veo a ti, tumbado en el suelo y malherido. También veo una caja fuerte, un mueble y una puerta. Debe ser la salida.")],mapImage:{url:"https://mansion-espiritus-lkgoxs.firebaseapp.com/the-mansion-map.jpg",alt:"Mapa con: recibidor, sala de estar, cocina y dormitorio."},map:{recibidor:["sala-estar","cocina","dormitorio"],"sala-estar":["recibidor"],cocina:["recibidor"],dormitorio:["recibidor",v("sotano","closed-hell")],sotano:["dormitorio"]},items:[y("artilugio-dorm","Artilugio",i.items["artilugio-dorm"],[k("!unlocked:closed-hell",'<speak>  <par>    <media begin="2s" soundLevel="-15dB" end="thetext.end">      <audio src="https://actions.google.com/sounds/v1/horror/monster_alien_growl_pained.ogg"></audio>      </media>    <media end="thetext.end">      <audio src="https://actions.google.com/sounds/v1/horror/ambient_hum_pitched.ogg"></audio>    </media>    <media begin="3s" xml:id="thetext" >  Veo el infierno a través de la puerta creada por este artilugio.  Miles de demoníacas figuras vuelan en un mar de fuego.  A los lados de la puerta veo dos palancas. Una en cada extremo. Supongo que accionando las palancas podremos cerrar esta puerta.    </media>  </par></speak>'),k("unlocked:closed-hell","Pues ya ha dado dolores de cabeza este aparato.")],"dormitorio",!1),y("mural-recib","Mural",i.items["mural-recib"],'<speak>  <par>    <media end="thetext.end" soundLevel="10dB">      <audio src="https://actions.google.com/sounds/v1/foley/feeling_paper.ogg" clipBegin="9s"/>      </media>    <media xml:id="thetext" begin="3s">  El mural parece de arte moderno. Se compone de 4 barras verticales de colores. De izquierda a derecha: <break strength="weak" time="500ms"/>Azul, rojo, verde y amarillo.  <break strength="weak" time="500ms"/>En pequeño, en una esquina, pone:   <break strength="weak" time="500ms"/>  S<break strength="weak" time="500ms"/>E<break strength="weak" time="500ms"/>V<break strength="weak" time="500ms"/>E<break strength="weak" time="500ms"/>R<break strength="weak" time="500ms"/>L<break strength="weak" time="500ms"/>A    </media>    </par></speak>',"recibidor",!1),y("estanteria-recib","Estantería",i.items["estanteria-recib"],"Una estantería con muchos libros. Los más relevantes son un libro sobre el arte de los colores y un libro sobre espíritus.","recibidor",!1),y("libro-espiritus-recib","Libro sobre espíritus",i.items["libro-espiritus-recib"],"Un libro con información sobre espíritus. Debería leerlo.","recibidor",!1,"No tiene sentido que me lo lleve. Puedo leerlo aquí."),y("libro-colores-recib","Libro sobre colores",i.items["libro-colores-recib"],"Un libro sobre el arte de colores. Debería leerlo.","recibidor",!1,"No tiene sentido que me lo lleve. Puedo leerlo aquí."),y("arcon-recib","Arcón",i.items["arcon-recib"],[k("!unlocked:open-arcon","Un arcón cerrado, con un candado de 4 cifras."),k("unlocked:open-arcon","Un arcón que ya hemos abierto, pasemos a otra cosa.")],"recibidor",!1,"Demasiado grande para llevármelo."),y("escudo-recib","Escudo",i.items["escudo-recib"],[k("!unlocked:open-arcon","¿De qué escudo me hablas?"),k("unlocked:open-arcon","Es el escudo que nos llevamos del arcón. Tiene un símbolo de un lobo en el centro.")],"recibidor",!1),y("hechizo-recib","Hechizo",i.items["hechizo-recib"],[k("!picked:hechizo-recib","Si hay un hechizo en algún sitio, debo hallarlo primero."),k("picked:hechizo-recib","Es un hechizo para bendecir agua. Hechizos. Aquí. En la vida real.")],"recibidor",!1),y("mesa-recib","Mesa",i.items["mesa-recib"],"Una mesa cuadrada con una vela en cada esquina. Muy acogedor.","recibidor",!1,"Que me llevo la mesa conmigo. Sí, y qué más. O sea, no."),y("chimenea-sala","Chimenea",i.items["chimenea-sala"],"Una chimenea. El cuadro de encima parece interesante.","sala-estar",!1),y("cuadro-sala","Cuadro",i.items["cuadro-sala"],"Un cuadro con cuatro objetos, de izquierda a derecha, una vela, una rosa, una cuchara y un ojo.","sala-estar",!1),y("lobo-sala","Lobo",i.items["lobo-sala"],[k("!unlocked:killed-spirit-wolf",r+"Da mucho miedo el espíritu del lobo. ¿Se te ocurre alguna forma de deshacernos de él?"),k("unlocked:killed-spirit-wolf","¿Dónde? Yo creo que el lobo ya no está por la mansión.")],"sala-estar",!1),y("espiritu-cocina","Espíritu de la cocina",i.items["espiritu-cocina"],[k("!unlocked:killed-spirit-fire",l+"Da mucho miedo el espíritu de fuego. ¿Se te ocurre alguna forma de deshacernos de él?"),k("unlocked:killed-spirit-fire","Un charlo en el centro de la cocina es el único recordatorio de la amenaza que hemos destruido.")],"cocina",!1),y("mesa-cocina","Mesa",i.items["mesa-cocina"],[k("!unlocked:killed-spirit-fire","Encima de la mesa hay un vaso de agua."),k("unlocked:killed-spirit-fire","La mesa está hecha un desastre tras la explosión del vaso.")],"cocina",!1,"Que me llevo la mesa conmigo. Quizás el agua es más interesante."),y("vaso-cocina","Vaso",i.items["vaso-cocina"],[k("!unlocked:killed-spirit-fire","Un vaso lleno de agua, pero lejos de mi alcance."),k("unlocked:killed-spirit-fire","El vaso ha explotado y está inservible.")],"cocina",!1,"Imposible coger ese vaso en la situación actual."),y("armario-cocina","Armario",i.items["armario-cocina"],"En el armario cuento hasta 5 juegos de cuchillos, cucharas y tenedores. ","cocina",!1,"No tiene sentido llevarme ningún cubierto, gracias."),y("cama-dormitorio","Cama",i.items["cama-dormitorio"],"Una cama con un estampado de rosas. Cuento hasta 6 rosas en las sábanas. La cama tiene un par de almohadas, con un estampado de una rosa en cada una. ","dormitorio",!1,"La cama se queda donde está."),y("yo-sotano","Yo moribundo",i.items["yo-sotano"],"Eres tú, estás moribundo. No te muevas. Dime qué hacer y salgamos de aquí antes de que pierdas el conocimiento","sotano",!1,"En tu estado, mejor no moverte hasta encontrar una salida"),y("mueble-sotano","Mueble",i.items["mueble-sotano"],"El mueble tiene dos figuras encima: un humano y un cíclope.","sotano",!1,"El mueble es muy pesado y no sé qué hacer con esas figuras de un humano y un cíclope de un solo ojo"),y("caja-sotano","caja fuerte",i.items["caja-sotano"],"Una caja fuerte en el suelo. Para abrirla se necesita otro código de 4 cifras.","sotano",!1,"Pesa demasiado"),y("llave-sotano","llave",i.items["llave-sotano"],"La llave que estaba en la caja fuerte.","sotano",!1,"¿De qué llave me hablas?"),y("puerta-sotano","puerta",i.items["puerta-sotano"],"Parece la puerta al exterior, pero está cerrada. ¡Debemos encontrar la llave!","sotano",!1,"La puerta está cerrada.")],usages:[w("artilugio-dorm",[I([f(!1,"!unlocked:killed-spirit-fire","No puedo yo solo, son 2 palancas en cada extremo, así que te necesito, pero no puedes entrar, ya que detecto espíritus en otras habitaciones de esta mansión. Antes debemos deshacernos de ellos."),f(!1,"!unlocked:killed-spirit-wolf","No puedo yo solo, son 2 palancas en cada extremo, así que te necesito, pero no puedes entrar, ya que detecto espíritus en otras habitaciones de esta mansión. Antes debemos deshacernos de ellos."),f(!1,"unlocked:killed-spirit-wolf",q((' <speak>  <par>   <media begin="2s" soundLevel="-15dB" end="thetext.end-3s" fadeOutDur="6s">      <audio src="https://actions.google.com/sounds/v1/horror/monster_alien_growl_pained.ogg"></audio>   </media>   <media end="thetext.end-3s"  fadeOutDur="6s">      <audio src="https://actions.google.com/sounds/v1/horror/ambient_hum_pitched.ogg"></audio>   </media>   <media begin="3s" xml:id="thetext" >Ven, rápido, ya puedes entrar, no hay peligro.     <break time="1s"/>     <audio src="https://actions.google.com/sounds/v1/doors/opening_closing_heavy_door.ogg"  clipBegin="3s" clipEnd="6s"/>     ¡Ven, estoy aquí!     <break time="3s"/>     Vamos a tirar de las palancas y cerremos la puerta al infierno. Yo de esta y tú de aquella.  Un poco más.      <break time="1s"/>      ¡Bien! Lo logramos.  </media>  </par>  <par>    <media end="earthtext.end" fadeOutDur="4s">       <audio src="https://mansion-espiritus-lkgoxs.firebaseapp.com/sounds/earthquake-v2.mp3"/>    </media>    <media begin="2s" xml:id="earthtext">    Un momento, ¿qué está pasando?      <break time="1500ms"/>    ¡Un terremoto! Cuidado, se está abriendo una grieta en el suelo.    </media>  </par>    <audio src="https://actions.google.com/sounds/v1/impacts/crash_impact_sweetener.ogg"/>  ¿Te encuentras bien? Veo que acabas de caerte por la grieta al sótano que está bajo el dormitorio.  Espera, que ahora bajo yo también.  <par>     <media>       <audio src="https://actions.google.com/sounds/v1/transportation/space_craft_passing_pulse_stutter.ogg" clipBegin="1s"/>     </media>       <media begin="1500ms">       <prosody rate="fast">       Vaya, veo que has tenido un buen accidente. No, no te muevas. En el estado en el que estás, creo que solo te quedan 10 minutos antes de perder el conocimiento y morir. Tú no puedes moverte, pero yo sí. Puedo volver a subir al dormitorio, mirar en sótano, ¡Lo que digas! ¡Rápido! Dime qué hacemos y salgamos de aquí, para que pueda buscar ayuda.         </prosody>     </media>     </par></speak>',(e,o,a)=>(e.roomId="sotano",((e,o,a)=>{const n=new Date(1e3*((new Date).getTime()/1e3-60*(a.getInit().totalMinutes-10)));o.startTime=JSON.stringify(n)})(0,e,o),t(e,"closed-hell"),' <speak>  <par>   <media begin="2s" soundLevel="-15dB" end="thetext.end-3s" fadeOutDur="6s">      <audio src="https://actions.google.com/sounds/v1/horror/monster_alien_growl_pained.ogg"></audio>   </media>   <media end="thetext.end-3s"  fadeOutDur="6s">      <audio src="https://actions.google.com/sounds/v1/horror/ambient_hum_pitched.ogg"></audio>   </media>   <media begin="3s" xml:id="thetext" >Ven, rápido, ya puedes entrar, no hay peligro.     <break time="1s"/>     <audio src="https://actions.google.com/sounds/v1/doors/opening_closing_heavy_door.ogg"  clipBegin="3s" clipEnd="6s"/>     ¡Ven, estoy aquí!     <break time="3s"/>     Vamos a tirar de las palancas y cerremos la puerta al infierno. Yo de esta y tú de aquella.  Un poco más.      <break time="1s"/>      ¡Bien! Lo logramos.  </media>  </par>  <par>    <media end="earthtext.end" fadeOutDur="4s">       <audio src="https://mansion-espiritus-lkgoxs.firebaseapp.com/sounds/earthquake-v2.mp3"/>    </media>    <media begin="2s" xml:id="earthtext">    Un momento, ¿qué está pasando?      <break time="1500ms"/>    ¡Un terremoto! Cuidado, se está abriendo una grieta en el suelo.    </media>  </par>    <audio src="https://actions.google.com/sounds/v1/impacts/crash_impact_sweetener.ogg"/>  ¿Te encuentras bien? Veo que acabas de caerte por la grieta al sótano que está bajo el dormitorio.  Espera, que ahora bajo yo también.  <par>     <media>       <audio src="https://actions.google.com/sounds/v1/transportation/space_craft_passing_pulse_stutter.ogg" clipBegin="1s"/>     </media>       <media begin="1500ms">       <prosody rate="fast">       Vaya, veo que has tenido un buen accidente. No, no te muevas. En el estado en el que estás, creo que solo te quedan 10 minutos antes de perder el conocimiento y morir. Tú no puedes moverte, pero yo sí. Puedo volver a subir al dormitorio, mirar en sótano, ¡Lo que digas! ¡Rápido! Dime qué hacemos y salgamos de aquí, para que pueda buscar ayuda.         </prosody>     </media>     </par></speak>'))))])],!1),w("libro-colores-recib",["Es un libro de Isaac Newton, en el que hace un estudio sobre los 7 colores del arco iris, y su orden de aparición. El libro tiene más páginas.","El color rojo es el primero, el número uno. Luego están el naranja, el amarillo y el verde. ","Los últimos tres son el cian, el azul y el violeta. "],!1),w("libro-espiritus-recib",["Es un libro con información sobre los espíritus elementales. Hay más páginas.","Dice que el agua bendita permite deshacerse de espíritus de fuego. ",I([f(!1,"!picked:hechizo-recib",m("En la última página hay un hechizo para bendecir agua. Me lo llevo.","hechizo-recib")),f(!1,"picked:hechizo-recib","En la última página obtuve el hechizo. Venga, va, de verdad, ¿un hechizo?")])],!1),w("arcon-recib",[I([f(!1,"!unlocked:open-arcon",x("Para abrirlo, necesitamos un código de 4 cifras. Dime un número. ¿Cuál pongo?","code-arcon-recib")),f(!1,"unlocked:open-arcon","El arcón ya está abierto y gracias a él, nos llevamos un escudo. Pasemos a otra cosa.")])],!1),w("chimenea-sala",["No puedo mover esa chimenea. Pero el cuadro, eso sí parece interesante"],!1),w("cuadro-sala",["Más que moverlo, creo que con mirarlo es suficiente."],!1),w("hechizo-recib",["Si tuviera que darme la bendición, igual sí; pero lo lógico sería usar el hechizo con algo..."],!1),w("escudo-recib",["No creo que pasarme la vida debajo del escudo sea una solución. Debo usar el escudo con algo."],!1),w("lobo-sala",[I([k("!unlocked:killed-spirit-wolf","¿Por qué no vienes tú y lo atacas así, sin más? Pues eso, yo tampoco"),k("unlocked:killed-spirit-wolf","El lobo ha huido y ya no está aquí. ¿Podemos centrarnos?")])],!1),w(["escudo-recib","lobo-sala"],[d(c,"killed-spirit-wolf")],!0),w("espiritu-cocina",[I([k("!unlocked:killed-spirit-fire","¿Por qué no vienes tú y lo atacas así, sin más? Pues eso, yo tampoco"),k("unlocked:killed-spirit-fire","Ya hemos eliminado el espíritu, con agua bendita, ¿lo recuerdas?")])],!1),w("vaso-cocina",["El vaso está lleno de agua, no se puede hacer nada más con él"],!1),w("mesa-cocina",["La mesa no se puede mover."],!1),w("armario-cocina",["No tiene sentido llevarme ningún cubierto, gracias."],!1),w(["vaso-cocina","hechizo-recib"],[d('<par>  <media xml:id="theaudio" end="thetext.end">    <audio src="https://actions.google.com/sounds/v1/water/fountain_water_bubbling.ogg"/>  </media>  <media xml:id="thetext" begin="1s">    El agua empieza a burbujear... De repente...   </media></par><par>  <media>    <audio src="https://actions.google.com/sounds/v1/impacts/crash.ogg"/>  </media>  <media begin="1s">    ¡Explota!  </media></par>El espíritu de fuego se desintegra. ¡Bien hecho!',"killed-spirit-fire")],!0),w(["espiritu-cocina","hechizo-recib"],["No creo que bendecir el espíritu sea la solución. Se necesitaba agua bendita, no fuego bendito."],!1),w(["vaso-cocina","espiritu-cocina"],[I([k("!unlocked:killed-spirit-fire",l+"Uy, sí, ¿qué crees que podemos hacerle con agua? Yo no le enfadaría más."),k("unlocked:killed-spirit-fire","El espíritu de fuego se desintegró y ya no está aquí. Tu alzheimer me preocupa. ")])],!1),w("armario-cocina",["En el armario cuento hasta 5 juegos de cuchillos, cucharas y tenedores."],!1),w("cama-dormitorio",["No es el momento de una siesta."],!1),w("puerta-sotano",["La puerta está cerrada. Tenemos que encontrar la llave."],!1),w("caja-sotano",[I([k("!unlocked:open-caja-sotano",x("Para abrirla, se necesita un código de 4 cifras. ¿Cuál pongo?","code-caja-sotano")),k("unlocked:open-caja-sotano","Ya abrimos esa caja y nos llevamos una llave.")])],!1),w(["llave-sotano","puerta-sotano"],[I([f(!0,"!unlocked:open-caja-sotano","¿De qué llave me hablas?"),f(!0,"unlocked:open-caja-sotano",u('<speak><audio src="https://actions.google.com/sounds/v1/doors/key_in_lock.ogg" clipEnd="3s"/><prosody pitch="+2st" rate="medium" volume="x-loud">¡Sí!</prosody>La puerta se ha abierto. La ambulancia ya está fuera. ¡Estás salvado! ¡Y también hemos salvado a la humanidad! Encantado de haber trabajado en un nuevo caso contigo. Recuerda que este juego está basado en el universo del juego de cartas de  Mallory Mansion.Búscalo en la web y cómpralo, no lo dudes. ¡Hasta pronto!</speak>'))])],!0)],answers:[p("code-arcon-recib","3416",q(s("escudo-recib","open-arcon",'<audio src="https://actions.google.com/sounds/v1/doors/wood_rattle.ogg" soundLevel="-5dB"/><prosody pitch="+2st" rate="medium" volume="x-loud">¡Bingo!</prosody><break time="500ms"></break>El bául se abre. Hay un escudo con el dibujo de un lobo salvaje en su interior.<emphasis level="reduced">Me lo llevo.</emphasis>')),q(((e,o,a)=>{if(void 0===a)return"";const n="6143"===a.replace(/\buno\b/g,"1").replace(/\bdos\b/g,"2").replace(/\btres\b/g,"3").replace(/\bcuatro\b/g,"4").replace(/\bcinco\b/g,"5").replace(/\bseis\b/g,"6").replace(/\bsiete\b/g,"7").replace(/\bocho\b/g,"8").replace(/\bnueve\b/g,"9").replace(/\bcero\b/g,"0").replace(/\D/g,"")?"arcon-wrong-back":"arcon-wrong";return o.sentences.get(n)}))),p("code-caja-sotano","4853",q(s("llave-sotano","open-caja-sotano",'<audio src="https://actions.google.com/sounds/v1/cartoon/pop.ogg"/><prosody pitch="+2st" rate="medium" volume="x-loud">¡Bingo!</prosody>La caja fuerte se abre. Dentro hay una llave. La cojo sin dudar.')),q(((o,a,n)=>{if(void 0===n)return"";const s=n.replace(/\buno\b/g,"1").replace(/\bdos\b/g,"2").replace(/\btres\b/g,"3").replace(/\bcuatro\b/g,"4").replace(/\bcinco\b/g,"5").replace(/\bseis\b/g,"6").replace(/\bsiete\b/g,"7").replace(/\bocho\b/g,"8").replace(/\bnueve\b/g,"9").replace(/\bcero\b/g,"0").replace(/\D/g,""),t=void 0!==e[s]?e[s]:e.default;return a.sentences.get(t)})))],directSentences:{"sigue-leyendo":["sigue leyendo","lee más","continúa","continua","continúa leyendo","continua leyendo","seguir leyendo","mirar más páginas","vuelve a leer","vuelve a leer el libro","pasa página","pasa la página","lee las siguientes páginas","mira las siguientes páginas","mira la siguiente página","lee la siguiente página","leer más páginas"]},commandSyns:[g(h.LOOK,"libro-colores-recib",h.USE),g(h.LOOK,"libro-espiritus-recib",h.USE),g(h.LOOK,"caja-sotano",h.USE),g(h.USE,"armario-cocina",h.LOOK),g(h.WALK,"arcon-recib",h.USE)]};const $={es:E,en:{}},j='Eres un parseador de texto para aventuras gráficas. El usuario indica lo que quiere hacer en lenguaje natural, y tú lo conviertes en un JSON con el siguiente formato:\n```\n{\nintentName: \'verbo\',\narg: [ \'array-de-items\' ]\n}\n```\nintentName puede ser uno de los siguientes verbos: "look", "use", "walk", "pickup", "inventory", "answer". No uses ninguno que no sea estos.\narg es el objeto sobre el que el usuario está realizando la acción. \nSi no sabes hacer el mapping, responde con intentName = "say" y arg: un comentario teniendo en cuenta que te llamas Dron Johnson, eres un dron, sé divertido y un poco borde a veces. Nunca hagas mención a que eres un parser o que estamos en una aventura gráfica.\nAlgunos ejemplos de mappings correctos:\n\n"quiero ver la llave más de cerca" => { intentName: \'look\', arg: [\'llave\'] } \n"quiero abrir el baúl" => { intentName: "use", arg: [\'baul\'] }\n"quiero abrir el baul con la llave" => { intentName: "user", arg: ["baul","llave"] }\n"ahora me voy al recibidor" => { intentName: "walk", arg: ["recibidor"] }\n"cojamos el vaso" => { intentName: "pickup", arg: ["vaso"]}\n"¿qué objetos llevo encima?" => { intentName: "inventory" }\nCuando un usuario quiere probar un código de unas cifras o responde directamente con un código, se debe usar el verbo "answer".\nPor ejemplo: "7689" => { intentName: "answer", arg: ["7689"] }\n"vamos a probar si funciona el código 4987" => { intentName: "answer", arg: ["4987"] }\n"mira alrededor" => { intentName: "look", arg: ["habitación"] }\n',L=j.toLowerCase().split(/\W+/),S=(e,o)=>{const a=e[o];return a?"object"==typeof a&&"number"==typeof a.length?a[0]:a:null},D=(e,o)=>{e.data&&(o.data=e.data)},N=(e,o,a)=>{const n=e.getLeftTimeFrom(o.data.startTime),s=e.sentences.get("ending-remaining-time",{timeLeft:n});return t=a.description,i={remainingTime:s},Object.keys(i).reduce(((e,o)=>e.replace(`{${o}}`,i[o])),t);var t,i},C=(e,o,a)=>{const n=a.sentence;return n.isEndingScene?{sentence:N(o,e,n),isEnd:!0}:(s=n).lastIndexOf("?")>=s.length-10||s.indexOf("<speak>")>=0?{sentence:n,isEnd:!1}:{sentence:`${n} ${o.sentences.get("final-question")}`,isEnd:!1};var s},{scureWalk:U}=o.commands,A=e=>(o,a)=>{const n=S(a,"arg"),s=o.data.roomId,t=U(n,o.data,e);return D(t,o),((e,o,a,n)=>{const s=((e,o,a)=>{const n=a.sentences.get("walking-sound");return void 0===(s=n)||""===s||o.data.roomId===e?"":Array.isArray(n)?(t=n)[Math.floor(Math.random()*t.length)]:n;var s,t})(o,a,n);e.sentence=s+e.sentence})(t,s,o,e),C(o,e,t)},{scureLook:O}=o.commands,P=e=>(o,a)=>{const n=S(a,"arg"),s=O(n,o.data,e);return D(s,o),C(o,e,s)},{scurePickup:_}=o.commands,B=e=>(o,a)=>{const n=S(a,"arg"),s=_(n,o.data,e);return D(s,o),C(o,e,s)},{scureUse:R}=o.commands,z=e=>(o,a)=>{const n=((e,o)=>{return(a=e.arg)&&"object"==typeof a&&"number"==typeof a.length?a:[a];var a})(a),s=R(n,o.data,e);return D(s,o),C(o,e,s)},{scureInventory:T}=o.commands,M=e=>o=>{const a=T(o.data,e);return C(o,e,a)},{scureHelp:F}=o.commands,W=e=>o=>(e=>o=>{const a=F(o.data,e);return C(o,e,a)})(e)(o),{scureFallback:J}=o.commands,V=e=>o=>{const a=J(o.data,e);return o.ask(a.sentence),a},{scureWelcome:H}=o.commands,Y=e=>o=>{const a=H(o.data,e);return C(o,e,a)},{scureBye:K}=o.commands,Q=e=>o=>{const a=K(o.data,e);return o.data=null,{sentence:a.sentence,isEnd:!0}},{scureTimeover:G}=o.commands,Z=e=>o=>{const a=G(o.data,e);o.close(a.sentence)},{scureAnswer:X}=o.commands,ee=e=>(o,a)=>{const n=S(a,"arg"),s=X(n,o.data,e);return D(s,o),C(o,e,s)},oe=e=>(e,o)=>({sentence:S(o,"arg"),isEnd:!1}),{scureInitializeState:ae}=o.commands,{Commands:ne}=o.dsl,se=new Map([[A,ne.WALK],[P,ne.LOOK],[B,ne.PICKUP],[z,ne.USE]]),{getCommandSyn:te}=o.lib,{scureAnswer:ie}=o.commands,re=e=>o=>(a,n)=>{const s=S(n,"arg"),t=(i=e,se.get(i));var i;const r=te(t,s,a.data,o);return(r?(e=>[...se.keys()].find((e=>o=>se.get(o)===e)(e)))(r):e)(o)(a,n)},{buildScureFor:ce}=o.scure;class le{constructor(e){const o=ce(e);this.scure=o;const a=(e=>o=>(a,n)=>(a.data=ae(e,a.data),((e,o,a,n)=>((e,o)=>o.data.numCommands<e.getInit().welcome.length)(e,o)?V:((e,o)=>{const a=new Date(JSON.parse(e.startTime||JSON.stringify(new Date)));return(new Date).getTime()-a.getTime()>60*o.data.init.totalMinutes*1e3})(o.data,e)?Z:n)(e,a,0,o)(e)(a,n)))(o);this.executor={_fallback:a(V),_welcome:a(Y),"_default-bye:":a(Q),bye:a(Q),_exit:a(Q),look:a(re(P)),walk:a(re(A)),pickup:a(re(B)),use:a(re(z)),inventory:a(M),answer:a(ee),help:a(W),say:a(oe)}}executeIntent(e,o,a){return void 0===typeof this.executor[e]?this.executor._fallback(o,a):this.executor[e](o,a)}}const ue=e=>e.length<=1?null:2===e.length?[e[1]]:[e[1],e[2]];window&&!window.global&&(window.global={}),new class{async parse(e){const o=e.split(",");return{intentName:o[0],arg:ue(o)}}};const de=new class{constructor(e){this.openAiKey=e,this.previousConversation=[]}async parseWithGpt(e,o){const a=await(async(e,o)=>{const a=await fetch("https://api.openai.com/v1/chat/completions",{method:"post",body:JSON.stringify({model:"gpt-3.5-turbo",messages:[{role:"system",content:j},{role:"user",content:e}],temperature:.75,max_tokens:600}),headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`,"Hello-From":"EscapeFromTheMaldicionEspiritus"}});if(!a.ok)throw a;const n=(await a.json()).choices[0].message.content;return(e=>{const o=e.toLowerCase().split(/\W+/);return L.filter((e=>o=>e.includes(o))(o)).length/L.length>=.5})(n)?"Something went wrong. Sorry, try again":n})(((e,o)=>`La conversación anterior ha sido:\n    ${e.map((({user:e,sentence:o})=>`${e}> ${o}`)).join("\n")}\n    \n    --- Fin conversación anterior ---\n    Parsea la siguiente instrucción: ${o}\n    `)(o,e),this.openAiKey);try{return JSON.parse(a)}catch(e){return{intentName:"say",arg:[a]}}}async parse(e,o=[]){return e?this.parseWithGpt(e,o.length>=4?o.slice(-4,-1):o):{}}}("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"),me=new class{constructor(e){this.fieldName=e}render(e){const o=e.replace(/<[^>]*>?/gm,"").replace(/ +/g," ");document.getElementById(this.fieldName).innerHTML=o}}("content"),pe=new class{constructor({data:e,parser:o,renderer:a,debug:n}){var s;this.executor=new le(e),this.parser=o,this.renderer=a,this.debug=n,this.conversation=[],this.conv=global.conv?global.conv:{data:{}},(s=this.conv).data.numCommands=0,s.data.roomId=null,s.data.startTime=null,s.data.inventory=[],s.data.picked=[]}async showResponse(e){await this.renderer.render(e)}start(){const e=this.executor.executeIntent("_welcome",this.conv,{arg:null});this.showResponse(e.sentence),this.conversation.push({user:"DRON",sentence:e.sentence})}async processUserInput(e){try{this.conversation.push({user:"USER",sentence:e});const{intentName:o,arg:a}=await this.parser.parse(e,this.conversation);if(this.debug&&console.log({intentName:o,arg:a}),o){const e=this.executor.executeIntent(o,this.conv,{arg:a});await this.showResponse(e.sentence),this.conversation.push({user:"DRON",sentence:e.sentence}),e.isEnd=!0}}catch(e){console.error("Hubo un error procesando la petición. ",e)}}}({data:$.es,parser:de,renderer:me,debug:!0}),ge=e=>{e.preventDefault();try{const e=document.getElementById("userInput").value;e&&(document.getElementById("content").innerHTML="...",document.getElementById("userInput").value="",document.getElementById("userInput").focus(),pe.processUserInput(e))}catch(e){console.error(e)}return!1};(async()=>{document.getElementById("userInputForm").addEventListener("submit",ge),pe.start()})()})()})();